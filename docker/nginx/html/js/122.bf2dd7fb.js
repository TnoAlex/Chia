"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[122],{122:function(t,e,a){a.r(e),a.d(e,{default:function(){return I}});var r=a(6252),n=a(9963);const s=t=>((0,r.dD)("data-v-5d1422aa"),t=t(),(0,r.Cn)(),t),o=s((()=>(0,r._)("head",null,[(0,r._)("meta",{charSet:"UTF-8"}),(0,r._)("title",null,"登录界面")],-1))),i={class:"container"},u={class:"forms-container"},d={class:"signin-signup"},l={class:"sign-in-form"},c=s((()=>(0,r._)("h2",{class:"title"},"学生登录",-1))),f={class:"input-field"},p=s((()=>(0,r._)("i",{class:"fas fa-user"},null,-1))),h={class:"input-field"},g=s((()=>(0,r._)("i",{class:"fas fa-lock"},null,-1))),m={class:"sign-up-form"},b=s((()=>(0,r._)("h2",{class:"title"},"教师登录",-1))),y={class:"input-field"},v=s((()=>(0,r._)("i",{class:"fas fa-user"},null,-1))),_={class:"input-field"},x=s((()=>(0,r._)("i",{class:"fas fa-lock"},null,-1))),A=(0,r.uE)('<div class="panels-container" data-v-5d1422aa><div class="panel left-panel" data-v-5d1422aa><div class="content" style="margin-right:200px;" data-v-5d1422aa><h3 data-v-5d1422aa>您是教师 ?</h3><p data-v-5d1422aa>请 点 击 此 处 进 行 登 录!</p><button id="sign-up-btn" class="btn transparent" data-v-5d1422aa>教师登录</button></div></div><div class="panel right-panel" data-v-5d1422aa><div class="content" data-v-5d1422aa><h3 data-v-5d1422aa>您是学生 ?</h3><p data-v-5d1422aa>请 点 击 此 处 进 行 登 录!</p><button id="sign-in-btn" class="btn transparent" data-v-5d1422aa>学生登录</button></div></div></div>',1);function w(t,e,a,s,w,C){const B=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)(r.HY,null,[o,(0,r._)("body",null,[(0,r._)("div",i,[(0,r._)("div",u,[(0,r._)("div",d,[(0,r._)("form",l,[c,(0,r._)("div",f,[p,(0,r.wy)((0,r._)("input",{id:"student_name","onUpdate:modelValue":e[0]||(e[0]=t=>w.loginObject.username=t),placeholder:"用户名",type:"text"},null,512),[[n.nr,w.loginObject.username]])]),(0,r._)("div",h,[g,(0,r.wy)((0,r._)("input",{id:"student_passwd","onUpdate:modelValue":e[1]||(e[1]=t=>w.loginObject.password=t),autocomplete:"off",placeholder:"密码",type:"password"},null,512),[[n.nr,w.loginObject.password]])]),(0,r.Wm)(B,{to:{path:"/forget_password",query:this.loginObject.type},class:"atag",style:{display:"block","text-align":"right"}},{default:(0,r.w5)((()=>[(0,r.Uk)("忘记密码 ")])),_:1},8,["to"]),(0,r._)("input",{class:"btn solid",type:"button",value:"登录",onClick:e[2]||(e[2]=(...t)=>C.submitForm&&C.submitForm(...t))})]),(0,r._)("form",m,[b,(0,r._)("div",y,[v,(0,r.wy)((0,r._)("input",{id:"teacher_name","onUpdate:modelValue":e[3]||(e[3]=t=>w.loginObject.username=t),placeholder:"用户名",type:"text"},null,512),[[n.nr,w.loginObject.username]])]),(0,r._)("div",_,[x,(0,r.wy)((0,r._)("input",{id:"teacher_passwd","onUpdate:modelValue":e[4]||(e[4]=t=>w.loginObject.password=t),autocomplete:"off",placeholder:"密码",type:"password"},null,512),[[n.nr,w.loginObject.password]])]),(0,r.Wm)(B,{to:{path:"/forget_password",query:this.loginObject.type},class:"atag",style:{display:"block","text-align":"right"}},{default:(0,r.w5)((()=>[(0,r.Uk)("忘记密码 ")])),_:1},8,["to"]),(0,r._)("input",{class:"btn",type:"button",value:"登录",onClick:e[5]||(e[5]=(...t)=>C.submitForm&&C.submitForm(...t))})])])]),A])])],64)}a(7658);var C=a(6133),B=a(2300),Z={name:"login",data(){return{userSatatus:0,loginObject:{type:0,username:"",password:""}}},mounted(){const t=document.querySelector("#sign-in-btn"),e=document.querySelector("#sign-up-btn"),a=document.querySelector(".container");e.addEventListener("click",(()=>{a.classList.add("sign-up-mode"),this.loginObject.type=1})),t.addEventListener("click",(()=>{a.classList.remove("sign-up-mode"),this.loginObject.type=0}))},methods:{async getUserInfo(){1===C.Z.userInfo.type?await this.$axios.get("/teacher/brief_info").then((t=>{C.Z.userInfo.userName=t.data.msg})).catch((t=>{null===t.data.data?C.Z.messageBox(t.data.msg,"error"):this.$router.push({path:"/error",errorCode:t.data.code,errorMsg:t.data.msg,errorCaused:t.data})})):await this.$axios.get("student/query/details").then((t=>{this.userSatatus=t.data.data.status,C.Z.userInfo.userName=t.data.data.name,C.Z.userInfo.studentNum=t.data.data.studentID,C.Z.userInfo.maxScore=t.data.data.maxScore,C.Z.userInfo.freeTime=t.data.data.freeTime,C.Z.userInfo.status=t.data.data.status,C.Z.userInfo.email=t.data.data.email,C.Z.userInfo.id=t.data.data.idNumber})).catch((t=>{this.$router.push({path:"/error",query:{errorCode:t.response.status,errorMsg:t.msg,errorCaused:t.response.data}})}))},async submitForm(){let t=C.Z.loadingWait("登录中..."),e=0;await C.Z.delay(100),await this.$axios.post("/login",JSON.stringify(this.loginObject)).then((()=>{C.Z.userInfo.type=this.loginObject.type,e=1})).catch((e=>{t.close(),500===e.response.status?(C.Z.messageBox("登录失败","error"),this.$router.push({path:"/error",query:{errorCode:e.response.status,errorMsg:e.msg,errorCaused:e.response.data}})):C.Z.messageBox("身份验证错误","error")})),0!==e&&(await this.getUserInfo(),await C.Z.delay(100),t.close(),0===e?C.Z.messageBox("登录失败","error"):(C.Z.messageBox("登录成功","success"),this.$cookies.set("userInfo",C.Z.userInfo),localStorage.setItem("userInfo",B.DS.toBase64(JSON.stringify(C.Z.userInfo))),0===this.userSatatus&&0===this.loginObject.type?this.$router.push("/enable_account"):this.$router.push("/index")))}}},S=a(3744);const U=(0,S.Z)(Z,[["render",w],["__scopeId","data-v-5d1422aa"]]);var I=U},2300:function(t,e,a){a.d(e,{DS:function(){return V},s3:function(){return Z}});const r="3.7.3",n=r,s="function"===typeof atob,o="function"===typeof btoa,i="function"===typeof Buffer,u="function"===typeof TextDecoder?new TextDecoder:void 0,d="function"===typeof TextEncoder?new TextEncoder:void 0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=Array.prototype.slice.call(l),f=(t=>{let e={};return t.forEach(((t,a)=>e[t]=a)),e})(c),p=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,h=String.fromCharCode.bind(String),g="function"===typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(t,e=(t=>t))=>new Uint8Array(Array.prototype.slice.call(t,0).map(e)),m=t=>t.replace(/=/g,"").replace(/[+\/]/g,(t=>"+"==t?"-":"_")),b=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),y=t=>{let e,a,r,n,s="";const o=t.length%3;for(let i=0;i<t.length;){if((a=t.charCodeAt(i++))>255||(r=t.charCodeAt(i++))>255||(n=t.charCodeAt(i++))>255)throw new TypeError("invalid character found");e=a<<16|r<<8|n,s+=c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}return o?s.slice(0,o-3)+"===".substring(o):s},v=o?t=>btoa(t):i?t=>Buffer.from(t,"binary").toString("base64"):y,_=i?t=>Buffer.from(t).toString("base64"):t=>{const e=4096;let a=[];for(let r=0,n=t.length;r<n;r+=e)a.push(h.apply(null,t.subarray(r,r+e)));return v(a.join(""))},x=(t,e=!1)=>e?m(_(t)):_(t),A=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?h(192|e>>>6)+h(128|63&e):h(224|e>>>12&15)+h(128|e>>>6&63)+h(128|63&e)}e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return h(240|e>>>18&7)+h(128|e>>>12&63)+h(128|e>>>6&63)+h(128|63&e)},w=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,C=t=>t.replace(w,A),B=i?t=>Buffer.from(t,"utf8").toString("base64"):d?t=>_(d.encode(t)):t=>v(C(t)),Z=(t,e=!1)=>e?m(B(t)):B(t),S=t=>Z(t,!0),U=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,I=t=>{switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),a=e-65536;return h(55296+(a>>>10))+h(56320+(1023&a));case 3:return h((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return h((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},O=t=>t.replace(U,I),F=t=>{if(t=t.replace(/\s+/g,""),!p.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));let e,a,r,n="";for(let s=0;s<t.length;)e=f[t.charAt(s++)]<<18|f[t.charAt(s++)]<<12|(a=f[t.charAt(s++)])<<6|(r=f[t.charAt(s++)]),n+=64===a?h(e>>16&255):64===r?h(e>>16&255,e>>8&255):h(e>>16&255,e>>8&255,255&e);return n},j=s?t=>atob(b(t)):i?t=>Buffer.from(t,"base64").toString("binary"):F,k=i?t=>g(Buffer.from(t,"base64")):t=>g(j(t),(t=>t.charCodeAt(0))),D=t=>k($(t)),E=i?t=>Buffer.from(t,"base64").toString("utf8"):u?t=>u.decode(k(t)):t=>O(j(t)),$=t=>b(t.replace(/[-_]/g,(t=>"-"==t?"+":"/"))),T=t=>E($(t)),q=t=>{if("string"!==typeof t)return!1;const e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},L=t=>({value:t,enumerable:!1,writable:!0,configurable:!0}),N=function(){const t=(t,e)=>Object.defineProperty(String.prototype,t,L(e));t("fromBase64",(function(){return T(this)})),t("toBase64",(function(t){return Z(this,t)})),t("toBase64URI",(function(){return Z(this,!0)})),t("toBase64URL",(function(){return Z(this,!0)})),t("toUint8Array",(function(){return D(this)}))},R=function(){const t=(t,e)=>Object.defineProperty(Uint8Array.prototype,t,L(e));t("toBase64",(function(t){return x(this,t)})),t("toBase64URI",(function(){return x(this,!0)})),t("toBase64URL",(function(){return x(this,!0)}))},z=()=>{N(),R()},V={version:r,VERSION:n,atob:j,atobPolyfill:F,btoa:v,btoaPolyfill:y,fromBase64:T,toBase64:Z,encode:Z,encodeURI:S,encodeURL:S,utob:C,btou:O,decode:T,isValid:q,fromUint8Array:x,toUint8Array:D,extendString:N,extendUint8Array:R,extendBuiltins:z}}}]);
//# sourceMappingURL=122.bf2dd7fb.js.map